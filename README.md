## AIoT 智慧農業決策助理系統：整合知識諮詢與設施自動化

### AIoT Smart Agriculture Decision Assistant System: Integrating Knowledge Consulting and Facility Automation

---

### **指導教授：**

**林錦財 教授**

### **組員：**

**張翊飛** **翁靖軒**

---

中華民國 114 年 6 月 (或根據實際完成日期填寫)

## 第 1 章 緒論與動機（Introduction and Motivation）

### 1.1 研究背景與專案動機

#### 1.1.1 時代背景：傳統農業轉型與挑戰

* 現狀分析：全球及本地農業正面臨的挑戰，如極端氣候、病蟲害威脅、農業人口老化與技術斷層等。  
* 痛點與需求：傳統農民缺乏即時、整合的決策輔助工具。例如：知識獲取效率低：遇到病蟲害時，需要花費大量時間翻閱資料或等待專家。  
  * 農場管理缺乏精準度：依賴經驗判斷澆水、施肥時機，導致資源浪費或產量不穩。

#### 1.1.2 專案動機：開發整合性智慧決策系統

* 核心目標：鑑於上述挑戰，本專題的動機是整合知識諮詢（AI/資料庫） 與設施自動化（IoT/自動控制），開發一套一站式的「智慧農業助理系統」。  
* 願景：旨在成為農民的虛擬助手，降低決策門檻，實現精準農業（Precision Agriculture），提升作物產量與品質。

### 1.2 專案目的

本專案旨在達成以下三個主要目標，以解決農民在知識、管理和決策上的痛點：

1. 建立即時農業知識諮詢能力：  
   * \[目標 1.1 \- 疾病快速判別\]：實作植物疫病判別功能，讓農民能透過照片或其他輸入，即時獲得病蟲害的初步診斷和應對建議。  
   * \[目標 1.2 \- 資訊整合\]：整合 Google 搜尋與農業資料庫檢索，提供全面且可信賴的農業知識查詢服務。  
2. 實現農場設施的智能化監控與控制：  
   * \[目標 2.1 \- 數據實時掌握\]：開發介面，能實時查詢實體氣象站的環境資訊（如溫濕度、光照）。  
   * \[目標 2.2 \- 自動化控制\]：實作自動澆水功能，可依據環境數據或預設排程進行精準灌溉。  
   * \[目標 2.3 \- 效率管理\]：提供工作排程功能，協助農民規劃、追蹤和提醒農事活動。  
   * \[目標 2.4 \- 數據可視化與即時預警\]：整合 Grafana 服務，將環境監測數據以儀表板形式可視化展示，並設定告警規則，透過 Webhook 機制向農民提供即時預警通知。  
3. 建構作物生長數據的數位化履歷：  
   * \[目標 3.1 \- 履歷記錄\]：設計介面以數位化方式便捷地紀錄作物從播種到收成的生長、用藥、施肥等關鍵數據。

### 1.3 專案範疇與限制

#### 1.3.1 專案範疇（Scope）

* 本專案將針對特定作物「草莓」進行疫病模型的訓練與系統優化。  
* 系統將包含前端介面（如 App 或 Web） 供農民操作，以及後端數據處理與物聯網（IoT） 模組的連接。

#### 1.3.2 專案限制（Limitation）

本專案旨在整合知識諮詢與設施自動化，但在實作與部署上存在以下限制：

* 核心焦點與資源限制：本專案將專注於語言模型（LLM）的資料整合與智慧決策能力。由於經費與資源限制，專案的發展重心將放在提升知識諮詢核心（如 Google Gemini AI Agent） 的即時性與準確度，而非大規模的物聯網（IoT）硬體部署。  
* 硬體及控制模擬限制：雖然專案目標包含實現農場設施的智能化監控與控制（如實時掌握數據與自動澆水功能），但現場設備控制部分（例如 Raspberry Pi 與 PLC 的協作執行） 將以資料或信號模擬方式呈現，或僅使用原型（Prototype）硬體進行模擬驗證，不涉及高可靠度的現場商業級部署或大規模控制。  
* 數據限制：疫病判別模型的準確度（本專案目標 1.1） 嚴格受限於可取得的訓練資料集數量與品質，這直接影響了系統診斷的可靠性。  
* 知識庫限制：知識諮詢服務（由 Gemini Agent 整合 Google Search 等工具提供） 主要基於公開資料庫與搜尋引擎，所提供的應對建議無法完全取代專業農學專家的現場診斷。

### 1.4 專題報告架構

本報告將依序說明「智慧農業助理」專案的執行過程與成果：

* 第 2 章：探討智慧農業、機器學習應用於病蟲害判別、以及物聯網系統建構的相關技術與文獻。  
* 第 3 章：詳細說明「智慧農業助理」的總體架構、資料庫設計與使用者介面（UI/UX） 設計。  
* 第 4 章：說明疫病判別模型的訓練流程與物聯網模組（氣象站、自動澆水）的實作細節。  
* 第 5 章：呈現系統測試結果與效能評估（如辨識準確度、系統穩定性）。  
* 第 6 章：總結專案成果，提出未來優化方向與商業發展建議。

## 第 2 章 相關技術或設計文獻探討（Related Technologies or Design Literature Review）

本章將回顧與「智慧農業助理系統」專案實作相關的關鍵技術原理、選用考量，並與現有解決方案進行比較，以突顯本專案的整合性與獨特性。

#### 2.1 關鍵技術原理介紹

本專案的核心在於結合人工智慧（AI）、雲端服務與物聯網（IoT）技術，以下針對所選用的關鍵技術進行簡要說明。

##### 2.1.1 智慧助理核心：Google Gemini 與 AI Agent 應用

* Google Gemini（大型語言模型, LLM）：  
  * 原理：Gemini 是一種多模態的大型語言模型，具備強大的自然語言理解（NLU）、自然語言生成（NLG）和推理能力。  
  * 專案應用：專案中將 Gemini 作為智慧農業助理的大腦，負責處理農民的知識諮詢請求、理解複雜的農業情境並生成專業、易懂的回覆。  
* AI Agent 框架與工具整合（Tool Use）：  
  * 原理：AI Agent 是一種基於 LLM 的系統，它能夠透過自主判斷來使用外部「工具」以完成任務。  
  * 專案應用：  
    * Google Search：為了提供即時且準確的農業資訊，本專案將 Google Search 作為 Gemini Agent 的其中一個工具。當農民提出特定、即時性的農業知識問題時，Agent 能調用 Google 搜尋，擴展其知識邊界，提供整合性的答案。  
    * 工作排程：依據使用者要求，將設備控制計畫，寫入資料庫。邊緣閘道器將依據排程執行指定任務，控制設備。

##### 2.1.2 疫病影像辨識服務：Azure Custom Vision

* 原理：Azure Custom Vision 是一項雲端服務，專門用於快速、便捷地建立、部署和改進自訂的電腦視覺模型。它屬於轉移學習（Transfer Learning）的應用，使用者只需提供目標物體的少量圖片即可訓練出專屬的影像分類或物件偵測模型。  
* 專案應用：專案利用其易用性，針對選定的作物類別，快速訓練一個植物疫病影像判別模型，使農民能透過拍攝病株葉片照片，立即獲得初步診斷。

##### 2.1.3 終端通訊介面：LINE Messaging API

* 原理：LINE Messaging API 允許開發者將 LINE 平台作為服務介面，透過文字、圖片、多媒體訊息與用戶進行互動。  
* 專案應用：考量到多數農民的行動設備使用習慣，本專案選擇 LINE 作為主要的使用者介面（UI/UX），透過建立 LINE Bot，大幅降低農民操作門檻，實現圖片上傳進行疫病判別、文字發問進行知識諮詢等功能。

##### 2.1.4 現場控制與數據採集：Raspberry Pi 與 PLC

* Raspberry Pi（樹莓派）：  
  * 原理：一種低成本、信用卡大小的單板電腦，具備 Wi-Fi 連線能力和 GPIO（General Purpose Input/Output） 針腳，適合作為物聯網（IoT） 的邊緣閘道器（Edge Gateway）。  
  * 專案應用：負責連接環境感測器（溫濕度、光照），實時採集環境數據，並將資料上傳至雲端資料庫。  
* PLC（可程式邏輯控制器）：  
  * 原理：專門為工業環境設計的數位電子操作裝置，以其高穩定性、抗干擾性和可靠性著稱，常用於工廠和自動化控制系統。  
  * 專案應用：在專案中，PLC 用於模擬高可靠度的自動化控制（如控制大型水泵、遮陽系統等），作為與 Raspberry Pi 協作的控制層，實現自動澆水等精準控制功能。

##### 2.1.5 數據監控與可視化服務

* Grafana：  
  * 原理：Grafana 是一種開源的數據分析、監控和可視化平台。它能連接多種數據源（例如雲端資料庫），並允許使用者建立高度客製化的圖形介面，以便追蹤數據趨勢、管理系統狀態以及設定複雜的告警規則。  
  * 專案應用：  
    * 數據儀表板 (Dashboard)：將 Raspberry Pi 上傳至雲端資料庫的實時環境數據（如溫濕度、光照）抽取出來，透過 Grafana 儀表板進行視覺化展示，使管理者能一目瞭然地掌握農場環境的歷史趨勢和即時狀態。  
    * 告警與通知 (Alerting & Webhook)：在 Grafana 中設定告警規則，例如當溫濕度超過草莓適宜生長的預設閾值時，系統將被觸發。接著，透過 Webhook 通知機制，將生成的警報訊息即時推送到 LINE Bot 介面，以實現對農民的即時預警功能。

### 2.2 相關產品或案例比較

為了彰顯本專案「智慧農業助理系統」的獨特性和優勢，本節將其與現有市場上的三大類解決方案進行比較：

| 比較項目 | 傳統農場管理模式 | 一般 IoT 智慧農業系統 | 獨立 AI 疫病辨識 App | 本專案：「智慧農業助理系統」 |
| :---- | :---- | :---- | :---- | :---- |
| 決策輔助 | 依賴經驗或專家 | 僅提供數據監測 | 僅提供疫病判斷 | 整合 AI 諮詢與數據決策 |
| 知識獲取 | 耗時翻閱資料/等待專家 | 無 | 缺乏廣泛農業知識 | 即時、整合（LLM \+ Google Search） |
| 農場控制 | 人工手動操作 | 僅具備基本遠端開關 | 無 | IoT 實時監控 \+ 自動化控制 |
| 介面親和力 | 紙本記錄/口頭傳達 | 需專用 App/Web 介面 | 需專用 App | 高普及率的 LINE 平台 |
| 系統整合度 | 破碎、不一致 | 數據與控制分離 | 獨立的單一功能 | 一站式知識、控制、履歷整合 |

優勢與獨特性總結：

* 一站式整合：相比於功能單一的獨立 App 或僅提供數據的 IoT 系統，本專案透過 Gemini AI Agent，有效地將知識諮詢、設施控制、數據監測及數位履歷整合在單一平台。  
* 高易用性介面：採用LINE Messaging API作為主要的農民互動介面，降低了傳統智慧農業系統對特定複雜 App 或 Web 介面的依賴，使技術門檻大幅降低。  
* 精準決策能力：結合 Azure Custom Vision 的專門疫病模型與 Gemini / Google Search 的廣泛知識庫，為農民提供了比單純依賴經驗更即時且精準的決策依據。

## 第 3 章 專案系統架構與設計（Project System Architecture and Design）

### 3.1 總體架構設計

本專案「AIoT 智慧農業決策助理系統」的設計核心，在於將知識諮詢（AI / 資料庫）與設施自動化（IoT / 自動控制）進行整合，開發出一套一站式的智慧農業助理系統。此架構結合了人工智慧（AI）、雲端服務與物聯網（IoT）技術，旨在將知識諮詢、設施控制、數據監測及數位履歷有效地整合在單一平台。

系統總體架構可分為三個主要層面：使用者介面層、智慧決策與雲端服務層，以及物聯網與現場控制層。

#### 3.1.1 系統總體架構圖

系統總體架構圖（圖 3.1.1）清晰描繪了這三個層面之間資料與控制命令的傳輸關係，並展示了各個關鍵技術組件（如 Gemini AI Agent、Azure Custom Vision、Raspberry Pi 和 PLC）的定位與相互協作方式。 
![圖 3.1.1 系統總體架構圖](./report/專題報告-3.1.1%20系統總體架構圖.png)  
圖 3.1.1 系統總體架構圖

#### 3.1.2 系統使用案例分析與功能範疇 (Use Case Analysis and Functional Scope)

為清晰界定系統的功能邊界與使用者互動模式，本節透過使用案例圖（Use Case Diagram）來呈現主要使用者（農民/使用者）與系統核心功能之間的關係。

農民作為主要參與者（Actor），可以透過 LINE Bot 介面 與系統進行互動，實現專案所定義的三大目標：即時知識諮詢、智能化監控與控制，以及數位化履歷建構。

核心使用案例範疇：

1. 知識諮詢與決策支援：  
   * 即時農業知識查詢： 透過文字發問，獲得 Gemini Agent 整合 Google Search 所提供的專業知識回覆（對應目標 1.2）。  
   * 疫病影像判別： 上傳病株葉片照片，利用 Azure Custom Vision 模型 獲得初步診斷與應對建議（對應目標 1.1）。  
2. 農場監控與自動化控制：  
   * 實時環境數據查詢： 透過介面即時讀取 Raspberry Pi 從環境感測器採集 的溫濕度、光照等數據（對應目標 2.1）。  
   * 設施排程設定/自動化控制： 設置或觸發自動澆水等精準灌溉功能，並將控制指令傳輸給 PLC 執行（對應目標 2.2）。  
3. 數位化記錄：  
   * 數位化履歷記錄： 在介面上便捷地記錄作物從播種到收成的生長、用藥、施肥等關鍵數據（對應目標 3.1）。

![圖 3.1.2 系統使用案例圖](./report/專題報告-3.1.2%20系統使用案例圖.png)  
圖 3.1.2 系統使用案例圖

#### 3.1.3 架構層面分析與組件職責

本系統將功能劃分為三個層面，以確保職責分離、易於維護與擴展。

##### 1\. 使用者介面層（User Interface Layer）

* LINE Bot（基於 LINE Messaging API）： 作為農民與系統互動的唯一入口。考量到多數農民的行動設備使用習慣，本專案選擇 LINE 作為主要的使用者介面（UI/UX），大幅降低了農民的操作門檻。農民可以透過 LINE 實現功能，例如：上傳圖片進行疫病判別、發送文字進行知識諮詢、以及實時查詢環境監測數據。

##### 2\. 智慧決策與雲端服務層（Intelligence and Cloud Service Layer）

此層是系統的「大腦」，負責處理所有複雜的決策邏輯、數據儲存與模型推論。

* 知識諮詢核心（Google Gemini Agent）： 具備強大的自然語言理解（NLU）和推理能力，負責處理農民的知識諮詢請求，並生成專業、易懂的回覆。Gemini Agent 能夠自主判斷並調用外部工具，如 Google Search，以擴展知識邊界。  
* 疫病影像辨識服務（Azure Custom Vision）： 專門用於實現植物疫病判別功能（對應目標 1.1）。此雲端服務用於部署針對特定作物類別訓練的電腦視覺模型。  
* 數據與履歷管理： 負責儲存從物聯網層上傳的實時環境監測數據（如溫濕度、光照），並管理農民透過介面輸入的作物數位化履歷數據。

##### 3\. 物聯網與現場控制層（IoT and On-Site Control Layer）

此層位於農場現場，負責實時數據採集和自動化控制指令的執行。

* 邊緣閘道器（Raspberry Pi）： 作為 IoT 的邊緣閘道器。它連接環境感測器，實時採集環境數據，並將資料上傳至雲端資料庫（對應目標 2.1）。  
* 自動化控制（PLC）： 採用 PLC（可程式邏輯控制器）用於模擬高可靠度的自動化控制。它作為控制層，與 Raspberry Pi 協作，用於實現自動澆水功能等精準控制（對應目標 2.2）。

#### 3.1.4 數據與控制流向

整體系統的運作流程遵循以下三個主要路徑，實現知識諮詢、環境監控與設施自動化的一體化整合：

1. 知識與決策流（Knowledge and Decision Flow）： 處理所有 AI 相關的諮詢與判別請求。  
2. 數據監控流（Data Monitoring Flow）： 負責現場環境數據的採集、上傳與實時查詢。  
3. 自動化控制流（Automated Control Flow）： 依據決策或排程，執行邊緣閘道器與 PLC 的控制操作。

#### 3.1.5 關鍵業務流程與數據流

1\. 知識與決策流（Knowledge and Decision Flow）

此流程旨在達成專案目標 1.1（疾病快速判別） 和 1.2（資訊整合）。它說明了系統如何透過 LINE Bot 接收農民的請求，並根據請求類型調用不同的 AI 服務（Gemini 或 Custom Vision）來提供即時的知識諮詢與決策支援。

| 步驟 | 流程細節 | 涉及組件 |
| ----- | ----- | ----- |
| 起始 | 農民透過 LINE Bot 介面輸入文字諮詢或上傳照片。 | 農民/使用者、LINE Bot |
| 判斷 | 系統判斷訊息類型：是知識諮詢（文字）還是 疫病判別（圖片）。 | 雲端服務層 |
| 路徑 A：疫病判別 | 圖片傳輸至 Azure Custom Vision 進行模型推論。 | Azure Custom Vision |
| 結果 A | 模型輸出初步 病蟲害診斷結果 與 應對建議，並由 Agent 整合。 | Azure Custom Vision、Gemini AI Agent |
| 路徑 B：知識諮詢 | 請求傳輸至 Gemini AI Agent 核心進行處理。 | Gemini AI Agent |
| 工具調用 | Agent 判斷是否需要調用 Google Search 等外部工具擴展知識邊界。 | Gemini AI Agent、Google Search |
| 數據整合 | Agent 存取雲端資料庫，以讀取數位履歷或歷史數據作為決策依據。 | Gemini AI Agent、雲端資料庫 |
| 結果 B | Agent 整合知識庫、搜尋結果與數據後，生成專業、易懂的回覆。 | Gemini AI Agent |
| 結束 | 診斷結果或專業建議回傳至 LINE Bot 介面，供農民閱讀。 | LINE Bot |

![圖 3.1.5-1 知識與決策流流程圖](./report/專題報告-3.1.5-1%20知識與決策流.png)  
圖 3.1.5-1 知識與決策流流程圖

##### 2\. 數據監控流（Data Monitoring Flow）

此流程旨在達成專案目標 2.1（數據實時掌握），說明現場感測器數據是如何採集、上傳並供農民即時查詢的。

| 步驟 | 流程細節 | 涉及組件 |
| :---- | :---- | :---- |
| 採集 | 環境感測器 （溫濕度、光照）實時採集農場現場數據。 | 環境感測器 |
| 傳輸 | Raspberry Pi （邊緣閘道器）接收感測器數據。 | Raspberry Pi |
| 上傳 | Raspberry Pi 將數據傳輸並 寫入 到 雲端資料庫 中進行實時儲存。 | Raspberry Pi、雲端資料庫 |
| 查詢請求 | 農民透過 LINE Bot 介面發送環境數據 實時查詢 請求。 | 農民/使用者、LINE Bot |
| 讀取 | 查詢請求發送至雲端， 讀取 最新的環境監測數據。 | 雲端資料庫 |
| 結束 | 數據回傳至 LINE Bot 介面，供農民 實時掌握 現場情況。 | LINE Bot |

![圖 3.1.5-2 數據監控流流程圖](./report/專題報告-3.1.5-2%20數據監控流.png)  
圖 3.1.5-2 數據監控流流程圖

##### 3\. 自動化控制流（Automated Control Flow）

此流程旨在達成專案目標 2.2（自動化控制），說明系統如何根據環境或排程條件，生成控制指令並透過 IoT 模組執行高可靠度的現場操作。

| 步驟 | 流程細節 | 涉及組件 |
| :---- | :---- | :---- |
| 觸發 | 觸發條件包括：感測器數據達到 預設閾值 （從資料庫讀取）、 預設排程 到達、或農民 手動指令。 | 雲端資料庫、使用者 |
| 決策 | 雲端決策邏輯 模組根據觸發條件，生成控制決策（例如：判斷需執行澆水）。 | 雲端決策邏輯 |
| 下發指令 | 控制指令 （如：打開水泵）透過網路下發至現場的 Raspberry Pi。 | 雲端服務層、Raspberry Pi |
| 執行指令 | Raspberry Pi 接收指令後，將控制訊號傳輸給 PLC。 | Raspberry Pi |
| 操作 | PLC 執行高可靠度的現場操作（例如：控制繼電器模擬自動澆水）。 | PLC |
| 回報 | PLC 將 控制狀態 回傳給 Raspberry Pi。 | PLC |
| 記錄 | Raspberry Pi 將控制執行的狀態和結果上傳至 雲端資料庫 進行記錄。 | Raspberry Pi、雲端資料庫 |

![圖 3.1.5-3 自動化控制流流程圖](./report/專題報告-3.1.5-3%20自動化控制流.png)  
圖 3.1.5-3 自動化控制流流程圖
